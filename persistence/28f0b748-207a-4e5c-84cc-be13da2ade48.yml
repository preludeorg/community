id: 28f0b748-207a-4e5c-84cc-be13da2ade48
name: Create Local User
description: Creates a local user on the specified computer
metadata:
  version: 1
  author:
    - w0rk3r
  tags:
    - Powerview
tactic: detection-validation
technique:
  id: T1136.001
  name: "Create Account: Local Account"
platforms:
  windows:
    psh:
      command: |
        $AccountPassword = '#{passwd}'
        $SamAccountName = '#{acc_name}'
        $ComputerName =  '#{computer}'
        $ObjOu = [ADSI]"WinNT://$ComputerName"
        $ObjUser = $ObjOu.Create('User', $SamAccountName)
        $ObjUser.SetPassword($AccountPassword)
        $Null = $ObjUser.SetInfo()
input_arguments:
  computer:
    description: Computer that the local user will be created
    type: String
    default: localhost
  passwd:
    description: Password for the user
    type: String
    default: Password123!
  user:
    description: User name
    type: String
    default: test1