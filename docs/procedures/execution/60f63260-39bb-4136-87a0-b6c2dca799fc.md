
# Install PowerShell Core 6

---

#### Metadata

- *Prelude ID*: 60f63260-39bb-4136-87a0-b6c2dca799fc
- *MITRE Technique ID*: [T1072](https://attack.mitre.org/techniques/T1072/)

---

### A hacker's perspective

---

In most secure environments, PowerShell is either restricted or the commands executed from it are logged and keywordanalyzed. This makes conducting an attack over this executor difficult. If I find myself in an enviornment like this,I may attempt to swap from the built-in PowerShell binary to open-source PowerShell Core. The former is launched underthe powershell.exe executable and the latter lauches under pwsh.exe. This matters because various security programsand logging agents may watch what happens under the launching executable carefully. If there is heavy security underpowershell.exe, I may have clear skies under pwsh.exe.

### Expected output

---

No usable shell output anticipated but a new agent should beacon in, replacing the original one.

### Basic variations

---

No significant variations will exist for this, except around how the PowerShell Core binary/program gets droppedon the computer in the first place. In this procedure, the .msi file is pulled off the PowerShell GitHub pagebecause PowerShell Core is not installed by default on most operating systems.

### Prevent + Detect

---

There are several preventitive steps to avoid an agent from swapping context between PowerShell and PowerShell Core.First, monitor and block the payload download. In general, log and monitor any website traffic generated by thepowershell.exe binary. In addition, ensure the same logging and monitoring exists for pwsh.exe, in case the attackergets the binary on the machine by some other means.

### How it is chained

---

This is likely one of the first actions a hacker will take after compromising a computer. From here, anticipateany number of PowerShell executed procedures. A common next step may be to kill all existing PowerShell processes (T1059.001),which would eliminate the previously running agent.
