
# Stop PowerShell processes

---

#### Metadata

- *Prelude ID*: 134b49a3-3f93-41bd-85f4-563eadbb6055
- *MITRE Technique ID*: [T1059.001](https://attack.mitre.org/techniques/T1059/001)

---

### A hacker's perspective

---

This is a destructive command which will stop all running PowerShell processes, including the one which is executingthis command itself. Why self destruct? Two reasons: I either want to kill my agent and remove all traces ofmyself on the box or I have switched context and have a new agent running under a non-PowerShell executor. Either way,the result is the same. I want to ensure that my initial process is no longer active so it removes one unnecessaryway to discover me. Because of the dual-cases, this will either be one of the first (switching context) or last (self-destruct)procedures I run during an attack.

### Expected output

---

No usable output will be generated by running this procedure.

### Basic variations

---

In this case, we're forcibly stopping all powershell.exe processes which are currently active. The name parametercould be swapped out to look for other process names, or use a wildcard such as p* to kill all processes whichstart with the letter "p". Depending on the goals of the adversary, they will stop processes prescriptively.

### Prevent + Detect

---

Preventing the stopping of a retrieved process is hard to do, if the process is of hte same privileges as the userinitiating the command (presumably so in this procedure). Which leaves detection. You should look to monitor anyforced stop of a process (or service for that matter) from a command-line executor, such as PowerShell. This would be arare behavior for a normal user.

### How it is chained

---

Force-stopping processes is likely preempted by a Process Discovery (T1057) procedure. It could also be chained toany number of impact or command-and-control procedures as well, such as Remote File Copy (T1544), if the hacker istrying to start a new agent, or Service Stop (T1489) and Defacement (T1491), if the hacker is doing noticable disruptiveactions.
