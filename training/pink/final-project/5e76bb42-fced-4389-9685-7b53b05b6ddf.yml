id: 5e76bb42-fced-4389-9685-7b53b05b6ddf
name: Your final project
challenge: |
  You work in the IT department of a small furniture store. Your boss walks up to you with a CISA report that shows 
  ransomware was last year's fastest growing cyber threat. She asks you how well prepared the store is against such
  an attack. Can you provide an answer?
context: |
  Start by reading the linked report. This will set the stage for what you will need to do in this final project. 
  Then select either a Windows or MacOS computer to act as your test environment. Get an agent running on this computer, 
  attached to your test environment, then write the following TTPs with proper Tactic and Techniques as listed below
  based on the mitigations section of the report:
  <ol>
      <li>
        Check if the computer is up-to-date with its security settings and/or patches. (Discovery: T1082)
      </li>
      <li>
        Check if RDP or SSH is installed and/or running on the computer. (Discovery: T1057)
      </li>
      <li>
        List all active network connections on the computer, so you can look for abnormal activity. (Discovery: T1046)
      </li>
      <li>
        Look for plain-text passwords held in text or CSV files on the computer. (Collection: T1005)
      </li>
      <li>
        Check if an antivirus installed and/or is running.  (Discovery: T1518)
      </li>
  </ol>
  Once you've written the five TTPs, create a chain and attach them to it. Once you've created the chain, deploy it against your
  target agent. Then enter the chain name within the input box and see if Operator can validate your results.
template:
  name: input
  data: []
resources:
  audio: []
  links:
    CISA report: https://www.cisa.gov/uscert/ncas/alerts/aa22-040a
hints:
  - Did you add the proper Tactic and Technique to the TTPs
  - Did all TTPs within the chain successfully deploy
blocks:
  What happens when I finish?: |
    Once you complete your final project, the Prelude team will be notified and you will receive an email containing
    your Pink Badge certificate.
answer:
  script: 
      new Promise((resolve, reject) => {
      const adversary = Object.values(Adversary.adversaries).filter(a => a.name === $('#answer').val())[0]
      const ttps = adversary.ttps.map(ttp => Attack.attack[ttp]);
      const rules = [
        (ttp) => ttp.tactic.toLowerCase() === "discovery" && ttp.technique.id.split('.') == "T1082" && ttp.platforms.darwin || ttp.platforms.windows,
        (ttp) => ttp.tactic.toLowerCase() === "discovery" && ttp.technique.id.split('.') == "T1057" && ttp.platforms.darwin || ttp.platforms.windows,
        (ttp) => ttp.tactic.toLowerCase() === "discovery" && ttp.technique.id.split('.') == "T1046" && ttp.platforms.darwin || ttp.platforms.windows,
        (ttp) => ttp.tactic.toLowerCase() === "discovery" && ttp.technique.id.split('.') == "T1518" && ttp.platforms.darwin || ttp.platforms.windows,
        (ttp) => ttp.tactic.toLowerCase() === "collection" && ttp.technique.id.split('.') == "T1005" && ttp.platforms.darwin || ttp.platforms.windows
      ];
      const validRules = rules.filter(rule => {
          return ttps.filter(ttp => rule(ttp)).length;
      });
      if (validRules.length === rules.length) {
        if (Agent.agents.filter(agent => ttps.filter(ttp => agent.links.filter(link => link.ttp === ttp.id).length).length === ttps.length).length) {
          return resolve(true);
        }
      }
      return resolve(false);
      });
  value: true
